{"ast":null,"code":"import \"react\";\n\nvar AWS = require(\"aws-sdk\");\n\nAWS.config.update({\n  accessKeyId: \"AKIAXKCRRSD3GJHJE65C\",\n  secretAccessKey: \"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\",\n  region: \"us-west-2\"\n});\nconst s3 = new AWS.S3();\n\nconst downloadS3 = (prefix, bucketName) => {\n  var allKeys = [];\n  const params = {\n    Bucket: bucketName,\n    Delimiter: \"/\",\n    Prefix: prefix,\n    StartAfter: prefix\n  };\n\n  function listAllKeys() {\n    s3.listObjectsV2(params, function (err, data) {\n      if (err) {\n        console.log(err, err.stack);\n      } else {\n        var contents = data.Contents;\n        contents.forEach(function (content) {\n          allKeys.push(content.Key);\n          console.log(\"1\", allKeys);\n        });\n\n        if (data.IsTruncated) {\n          params.ContinuationToken = data.NextContinuationToken;\n          console.log(\"There are more keys coming up\");\n          listAllKeys();\n        }\n      }\n    });\n  }\n\n  listAllKeys().then(console.log(allKeys));\n  console.log(allKeys.length);\n  console.log(\"yes\", allKeys[0]);\n  var nodesArray = [].slice.call(allKeys);\n  console.log(typeof nodesArray);\n  console.log(\"elements\", nodesArray); // allKeys.map(key => s3.getSignedUrl('getObject', {Bucket:bucketName,Key:key}, function (err, url) {\n  //     return url;\n  // });\n  //\n  //   var urlparams = {Bucket: 'max-client-logos', Key: allKeys[0]};\n  //   s3.getSignedUrl('getObject', urlparams, function (err, url) {\n  //     console.log('Your generated pre-signed URL is', url);\n  // });\n  //   let url = allKeys.map((key) => (s3.getSignedUrl('getObject', {\n  //     Bucket:\"max-client-logos\",\n  //     Key:key\n  //   }, function(err, url) {\n  //     console.log('Your generated pre-signed URL is', url);\n  //   }\n  // )));\n\n  return nodesArray;\n};\n\nexport default downloadS3;","map":{"version":3,"sources":["/Users/kaiweiwu/Documents/page_designer/page-designer/src/s3config.js"],"names":["AWS","require","config","update","accessKeyId","secretAccessKey","region","s3","S3","downloadS3","prefix","bucketName","allKeys","params","Bucket","Delimiter","Prefix","StartAfter","listAllKeys","listObjectsV2","err","data","console","log","stack","contents","Contents","forEach","content","push","Key","IsTruncated","ContinuationToken","NextContinuationToken","then","length","nodesArray","slice","call"],"mappings":"AAAA,OAAO,OAAP;;AAEA,IAAIA,GAAG,GAAGC,OAAO,CAAC,SAAD,CAAjB;;AACAD,GAAG,CAACE,MAAJ,CAAWC,MAAX,CAAkB;AACdC,EAAAA,WAAW,EAAE,sBADC;AAEdC,EAAAA,eAAe,EAAE,0CAFH;AAGdC,EAAAA,MAAM,EAAE;AAHM,CAAlB;AAKA,MAAMC,EAAE,GAAG,IAAIP,GAAG,CAACQ,EAAR,EAAX;;AAEA,MAAMC,UAAU,GAAG,CAACC,MAAD,EAASC,UAAT,KAAwB;AACvC,MAAIC,OAAO,GAAG,EAAd;AACA,QAAMC,MAAM,GAAG;AACXC,IAAAA,MAAM,EAAEH,UADG;AAEXI,IAAAA,SAAS,EAAE,GAFA;AAGXC,IAAAA,MAAM,EAAEN,MAHG;AAIXO,IAAAA,UAAU,EAAEP;AAJD,GAAf;;AAOA,WAASQ,WAAT,GAAuB;AACnBX,IAAAA,EAAE,CAACY,aAAH,CAAiBN,MAAjB,EAAyB,UAASO,GAAT,EAAcC,IAAd,EAAoB;AACzC,UAAID,GAAJ,EAAS;AACLE,QAAAA,OAAO,CAACC,GAAR,CAAYH,GAAZ,EAAiBA,GAAG,CAACI,KAArB;AACH,OAFD,MAEO;AACH,YAAIC,QAAQ,GAAGJ,IAAI,CAACK,QAApB;AACAD,QAAAA,QAAQ,CAACE,OAAT,CAAiB,UAASC,OAAT,EAAkB;AAC/BhB,UAAAA,OAAO,CAACiB,IAAR,CAAaD,OAAO,CAACE,GAArB;AACAR,UAAAA,OAAO,CAACC,GAAR,CAAY,GAAZ,EAAiBX,OAAjB;AACH,SAHD;;AAKA,YAAIS,IAAI,CAACU,WAAT,EAAsB;AAClBlB,UAAAA,MAAM,CAACmB,iBAAP,GAA2BX,IAAI,CAACY,qBAAhC;AACAX,UAAAA,OAAO,CAACC,GAAR,CAAY,+BAAZ;AACAL,UAAAA,WAAW;AACd;AACJ;AACJ,KAhBD;AAiBH;;AAEDA,EAAAA,WAAW,GAAGgB,IAAd,CAAmBZ,OAAO,CAACC,GAAR,CAAYX,OAAZ,CAAnB;AACAU,EAAAA,OAAO,CAACC,GAAR,CAAYX,OAAO,CAACuB,MAApB;AACAb,EAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAmBX,OAAO,CAAC,CAAD,CAA1B;AACA,MAAIwB,UAAU,GAAG,GAAGC,KAAH,CAASC,IAAT,CAAc1B,OAAd,CAAjB;AACAU,EAAAA,OAAO,CAACC,GAAR,CAAY,OAAOa,UAAnB;AACAd,EAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBa,UAAxB,EAlCuC,CAoCvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAAOA,UAAP;AACH,CApDD;;AAsDA,eAAe3B,UAAf","sourcesContent":["import \"react\";\n\nvar AWS = require(\"aws-sdk\");\nAWS.config.update({\n    accessKeyId: \"AKIAXKCRRSD3GJHJE65C\",\n    secretAccessKey: \"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\",\n    region: \"us-west-2\"\n});\nconst s3 = new AWS.S3();\n\nconst downloadS3 = (prefix, bucketName) => {\n    var allKeys = [];\n    const params = {\n        Bucket: bucketName,\n        Delimiter: \"/\",\n        Prefix: prefix,\n        StartAfter: prefix\n    };\n\n    function listAllKeys() {\n        s3.listObjectsV2(params, function(err, data) {\n            if (err) {\n                console.log(err, err.stack);\n            } else {\n                var contents = data.Contents;\n                contents.forEach(function(content) {\n                    allKeys.push(content.Key);\n                    console.log(\"1\", allKeys);\n                });\n\n                if (data.IsTruncated) {\n                    params.ContinuationToken = data.NextContinuationToken;\n                    console.log(\"There are more keys coming up\");\n                    listAllKeys();\n                }\n            }\n        });\n    }\n\n    listAllKeys().then(console.log(allKeys));\n    console.log(allKeys.length);\n    console.log(\"yes\", allKeys[0]);\n    var nodesArray = [].slice.call(allKeys);\n    console.log(typeof nodesArray);\n    console.log(\"elements\", nodesArray);\n\n    // allKeys.map(key => s3.getSignedUrl('getObject', {Bucket:bucketName,Key:key}, function (err, url) {\n    //     return url;\n    // });\n    //\n    //   var urlparams = {Bucket: 'max-client-logos', Key: allKeys[0]};\n    //   s3.getSignedUrl('getObject', urlparams, function (err, url) {\n    //     console.log('Your generated pre-signed URL is', url);\n    // });\n    //   let url = allKeys.map((key) => (s3.getSignedUrl('getObject', {\n    //     Bucket:\"max-client-logos\",\n    //     Key:key\n    //   }, function(err, url) {\n    //     console.log('Your generated pre-signed URL is', url);\n    //   }\n    // )));\n    return nodesArray;\n};\n\nexport default downloadS3;\n"]},"metadata":{},"sourceType":"module"}