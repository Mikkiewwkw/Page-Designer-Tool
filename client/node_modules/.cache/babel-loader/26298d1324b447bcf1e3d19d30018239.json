{"ast":null,"code":"var _jsxFileName = \"/Users/kaiweiwu/Documents/page_designer/page-designer/src/test.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\"; // import sign_s3 from \"logoUpload\";\n\nvar aws = require(\"aws-sdk\");\n\nrequire(\"dotenv\").config(); // Configure dotenv to load in the .env file\n// Configure aws with your accessKeyId and your secretAccessKey\n\n\nconst AWS = require(\"aws-sdk\");\n\nconst fs = require(\"fs\");\n\nconst fileType = require(\"file-type\");\n\nconst bluebird = require(\"bluebird\");\n\nconst multiparty = require(\"multiparty\"); // configure the keys for accessing AWS\n\n\nAWS.config.update({\n  accessKeyId: \"AKIAXKCRRSD3GJHJE65C\",\n  secretAccessKey: \"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\",\n  region: \"us-west-2\"\n}); // configure AWS to work with promises\n\nAWS.config.setPromisesDependency(bluebird); // create S3 instance\n\nconst s3 = new AWS.S3(); // abstracts function to upload a file returning a promise\n\nconst uploadFile = (buffer, name, type) => {\n  const params = {\n    ACL: \"public-read\",\n    Body: buffer,\n    Bucket: \"max-client-logos\",\n    ContentType: type.mime,\n    Key: \"\".concat(name, \".\").concat(type.ext)\n  };\n  return s3.upload(params).promise();\n}; //\n// const sign_s3 = (bucketName, req, res) => {\n//     const s3 = new aws.S3(); // Create a new instance of S3\n//     const fileName = req.body.fileName;\n//     const fileType = req.body.fileType;\n//     // Set up the payload of what we are sending to the S3 api\n//     const s3Params = {\n//         Bucket: bucketName,\n//         Key: fileName,\n//         Expires: 500,\n//         ContentType: fileType\n//     };\n//     // Make a request to the S3 API to get a signed URL which we can use to upload our file\n//     s3.getSignedUrl(\"putObject\", s3Params, (err, data) => {\n//         if (err) {\n//             console.log(err);\n//             res.json({ success: false, error: err });\n//         }\n//         // Data payload of what we are sending back, the url of the signedRequest and a URL where we can access the content after its saved.\n//         const returnData = {\n//             signedRequest: data,\n//             url: `https://${bucketName}.s3.amazonaws.com/${fileName}`\n//         };\n//         // Send it all back\n//         res.json({ success: true, data: { returnData } });\n//     });\n// };\n\n\nclass SketchExample extends Component {\n  constructor() {\n    super();\n\n    this.submitFile = event => {\n      event.preventDefault();\n      const formData = new FormData();\n      formData.append(\"file\", this.state.file[0]);\n      axios.post(\"/test-upload\", formData, {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\"\n        }\n      }).then(response => {// handle your response;\n      }).catch(error => {// handle your error\n      });\n    };\n\n    this.handleFileUpload = event => {\n      this.setState({\n        file: event.target.files\n      });\n    };\n\n    this.state = {\n      file: null\n    };\n  }\n\n  render() {\n    return React.createElement(\"form\", {\n      onSubmit: this.submitFile,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      label: \"upload file\",\n      type: \"file\",\n      onChange: this.handleFileUpload,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, \"Send\"));\n  }\n\n}\n\nexport default SketchExample;","map":{"version":3,"sources":["/Users/kaiweiwu/Documents/page_designer/page-designer/src/test.js"],"names":["React","Component","axios","aws","require","config","AWS","fs","fileType","bluebird","multiparty","update","accessKeyId","secretAccessKey","region","setPromisesDependency","s3","S3","uploadFile","buffer","name","type","params","ACL","Body","Bucket","ContentType","mime","Key","ext","upload","promise","SketchExample","constructor","submitFile","event","preventDefault","formData","FormData","append","state","file","post","headers","then","response","catch","error","handleFileUpload","setState","target","files","render"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\n// import sign_s3 from \"logoUpload\";\nvar aws = require(\"aws-sdk\");\nrequire(\"dotenv\").config(); // Configure dotenv to load in the .env file\n// Configure aws with your accessKeyId and your secretAccessKey\nconst AWS = require(\"aws-sdk\");\nconst fs = require(\"fs\");\nconst fileType = require(\"file-type\");\nconst bluebird = require(\"bluebird\");\nconst multiparty = require(\"multiparty\");\n\n// configure the keys for accessing AWS\nAWS.config.update({\n    accessKeyId: \"AKIAXKCRRSD3GJHJE65C\",\n    secretAccessKey: \"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\",\n    region: \"us-west-2\"\n});\n// configure AWS to work with promises\nAWS.config.setPromisesDependency(bluebird);\n\n// create S3 instance\nconst s3 = new AWS.S3();\n// abstracts function to upload a file returning a promise\nconst uploadFile = (buffer, name, type) => {\n    const params = {\n        ACL: \"public-read\",\n        Body: buffer,\n        Bucket: \"max-client-logos\",\n        ContentType: type.mime,\n        Key: `${name}.${type.ext}`\n    };\n    return s3.upload(params).promise();\n};\n\n//\n// const sign_s3 = (bucketName, req, res) => {\n//     const s3 = new aws.S3(); // Create a new instance of S3\n//     const fileName = req.body.fileName;\n//     const fileType = req.body.fileType;\n//     // Set up the payload of what we are sending to the S3 api\n//     const s3Params = {\n//         Bucket: bucketName,\n//         Key: fileName,\n//         Expires: 500,\n//         ContentType: fileType\n//     };\n//     // Make a request to the S3 API to get a signed URL which we can use to upload our file\n//     s3.getSignedUrl(\"putObject\", s3Params, (err, data) => {\n//         if (err) {\n//             console.log(err);\n//             res.json({ success: false, error: err });\n//         }\n//         // Data payload of what we are sending back, the url of the signedRequest and a URL where we can access the content after its saved.\n//         const returnData = {\n//             signedRequest: data,\n//             url: `https://${bucketName}.s3.amazonaws.com/${fileName}`\n//         };\n//         // Send it all back\n//         res.json({ success: true, data: { returnData } });\n//     });\n// };\n\nclass SketchExample extends Component {\n    constructor() {\n        super();\n        this.state = {\n            file: null\n        };\n    }\n\n    submitFile = event => {\n        event.preventDefault();\n        const formData = new FormData();\n        formData.append(\"file\", this.state.file[0]);\n        axios\n            .post(`/test-upload`, formData, {\n                headers: {\n                    \"Content-Type\": \"multipart/form-data\"\n                }\n            })\n            .then(response => {\n                // handle your response;\n            })\n            .catch(error => {\n                // handle your error\n            });\n    };\n\n    handleFileUpload = event => {\n        this.setState({ file: event.target.files });\n    };\n\n    render() {\n        return (\n            <form onSubmit={this.submitFile}>\n                <input\n                    label=\"upload file\"\n                    type=\"file\"\n                    onChange={this.handleFileUpload}\n                />\n                <button type=\"submit\">Send</button>\n            </form>\n        );\n    }\n}\n\nexport default SketchExample;\n"]},"metadata":{},"sourceType":"module"}