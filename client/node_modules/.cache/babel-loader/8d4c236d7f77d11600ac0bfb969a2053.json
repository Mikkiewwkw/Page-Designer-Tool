{"ast":null,"code":"var AWS = require(\"aws-sdk\");\n\nfunction listAllKeys(params, outPutArray) {\n  s3.listObjectsV2(params, function (err, data) {\n    if (err) {\n      console.log(err, err.stack);\n    } else {\n      var contents = data.Contents;\n      console.log(\"0\", contents);\n      contents.forEach(function (content) {\n        allKeys.push(content.Key);\n        console.log(\"1\", outPutArray);\n      });\n\n      if (data.IsTruncated) {\n        params.ContinuationToken = data.NextContinuationToken;\n        console.log(\"There are more keys coming up\");\n        listAllKeys(params, outPutArray);\n      }\n    }\n  });\n  console.log(\"2\", outPutArray);\n}\n\nconst downloadS3 = (prefix, bucketName) => {\n  const s3 = new AWS.S3();\n  var allKeys = [];\n  s3.config.update({\n    accessKeyId: \"AKIAXKCRRSD3GJHJE65C\",\n    secretAccessKey: \"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\",\n    region: \"us-west-2\"\n  });\n  const params = {\n    Bucket: bucketName,\n    Delimiter: \"/\",\n    Prefix: prefix,\n    StartAfter: prefix\n  };\n  listAllKeys(params, allKeys);\n  console.log(\"4\", allKeys); // allKeys.map(key => s3.getSignedUrl('getObject', {Bucket:bucketName,Key:key}, function (err, url) {\n  //     return url;\n  // });\n  //\n  //   var urlparams = {Bucket: 'max-client-logos', Key: allKeys[0]};\n  //   s3.getSignedUrl('getObject', urlparams, function (err, url) {\n  //     console.log('Your generated pre-signed URL is', url);\n  // });\n  //   let url = allKeys.map((key) => (s3.getSignedUrl('getObject', {\n  //     Bucket:\"max-client-logos\",\n  //     Key:key\n  //   }, function(err, url) {\n  //     console.log('Your generated pre-signed URL is', url);\n  //   }\n  // )));\n\n  return allKeys;\n};\n\nexport default downloadS3;","map":{"version":3,"sources":["/Users/kaiweiwu/Documents/page_designer/page-designer/src/s3config.js"],"names":["AWS","require","listAllKeys","params","outPutArray","s3","listObjectsV2","err","data","console","log","stack","contents","Contents","forEach","content","allKeys","push","Key","IsTruncated","ContinuationToken","NextContinuationToken","downloadS3","prefix","bucketName","S3","config","update","accessKeyId","secretAccessKey","region","Bucket","Delimiter","Prefix","StartAfter"],"mappings":"AAAA,IAAIA,GAAG,GAAGC,OAAO,CAAC,SAAD,CAAjB;;AAEA,SAASC,WAAT,CAAqBC,MAArB,EAA6BC,WAA7B,EAA0C;AACtCC,EAAAA,EAAE,CAACC,aAAH,CAAiBH,MAAjB,EAAyB,UAASI,GAAT,EAAcC,IAAd,EAAoB;AACzC,QAAID,GAAJ,EAAS;AACLE,MAAAA,OAAO,CAACC,GAAR,CAAYH,GAAZ,EAAiBA,GAAG,CAACI,KAArB;AACH,KAFD,MAEO;AACH,UAAIC,QAAQ,GAAGJ,IAAI,CAACK,QAApB;AACAJ,MAAAA,OAAO,CAACC,GAAR,CAAY,GAAZ,EAAiBE,QAAjB;AACAA,MAAAA,QAAQ,CAACE,OAAT,CAAiB,UAASC,OAAT,EAAkB;AAC/BC,QAAAA,OAAO,CAACC,IAAR,CAAaF,OAAO,CAACG,GAArB;AACAT,QAAAA,OAAO,CAACC,GAAR,CAAY,GAAZ,EAAiBN,WAAjB;AACH,OAHD;;AAKA,UAAII,IAAI,CAACW,WAAT,EAAsB;AAClBhB,QAAAA,MAAM,CAACiB,iBAAP,GAA2BZ,IAAI,CAACa,qBAAhC;AACAZ,QAAAA,OAAO,CAACC,GAAR,CAAY,+BAAZ;AACAR,QAAAA,WAAW,CAACC,MAAD,EAASC,WAAT,CAAX;AACH;AACJ;AACJ,GAjBD;AAkBAK,EAAAA,OAAO,CAACC,GAAR,CAAY,GAAZ,EAAiBN,WAAjB;AACH;;AAED,MAAMkB,UAAU,GAAG,CAACC,MAAD,EAASC,UAAT,KAAwB;AACvC,QAAMnB,EAAE,GAAG,IAAIL,GAAG,CAACyB,EAAR,EAAX;AACA,MAAIT,OAAO,GAAG,EAAd;AACAX,EAAAA,EAAE,CAACqB,MAAH,CAAUC,MAAV,CAAiB;AACbC,IAAAA,WAAW,EAAE,sBADA;AAEbC,IAAAA,eAAe,EAAE,0CAFJ;AAGbC,IAAAA,MAAM,EAAE;AAHK,GAAjB;AAMA,QAAM3B,MAAM,GAAG;AACX4B,IAAAA,MAAM,EAAEP,UADG;AAEXQ,IAAAA,SAAS,EAAE,GAFA;AAGXC,IAAAA,MAAM,EAAEV,MAHG;AAIXW,IAAAA,UAAU,EAAEX;AAJD,GAAf;AAOArB,EAAAA,WAAW,CAACC,MAAD,EAASa,OAAT,CAAX;AACAP,EAAAA,OAAO,CAACC,GAAR,CAAY,GAAZ,EAAiBM,OAAjB,EAjBuC,CAmBvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAAOA,OAAP;AACH,CAnCD;;AAqCA,eAAeM,UAAf","sourcesContent":["var AWS = require(\"aws-sdk\");\n\nfunction listAllKeys(params, outPutArray) {\n    s3.listObjectsV2(params, function(err, data) {\n        if (err) {\n            console.log(err, err.stack);\n        } else {\n            var contents = data.Contents;\n            console.log(\"0\", contents);\n            contents.forEach(function(content) {\n                allKeys.push(content.Key);\n                console.log(\"1\", outPutArray);\n            });\n\n            if (data.IsTruncated) {\n                params.ContinuationToken = data.NextContinuationToken;\n                console.log(\"There are more keys coming up\");\n                listAllKeys(params, outPutArray);\n            }\n        }\n    });\n    console.log(\"2\", outPutArray);\n}\n\nconst downloadS3 = (prefix, bucketName) => {\n    const s3 = new AWS.S3();\n    var allKeys = [];\n    s3.config.update({\n        accessKeyId: \"AKIAXKCRRSD3GJHJE65C\",\n        secretAccessKey: \"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\",\n        region: \"us-west-2\"\n    });\n\n    const params = {\n        Bucket: bucketName,\n        Delimiter: \"/\",\n        Prefix: prefix,\n        StartAfter: prefix\n    };\n\n    listAllKeys(params, allKeys);\n    console.log(\"4\", allKeys);\n\n    // allKeys.map(key => s3.getSignedUrl('getObject', {Bucket:bucketName,Key:key}, function (err, url) {\n    //     return url;\n    // });\n    //\n    //   var urlparams = {Bucket: 'max-client-logos', Key: allKeys[0]};\n    //   s3.getSignedUrl('getObject', urlparams, function (err, url) {\n    //     console.log('Your generated pre-signed URL is', url);\n    // });\n    //   let url = allKeys.map((key) => (s3.getSignedUrl('getObject', {\n    //     Bucket:\"max-client-logos\",\n    //     Key:key\n    //   }, function(err, url) {\n    //     console.log('Your generated pre-signed URL is', url);\n    //   }\n    // )));\n    return allKeys;\n};\n\nexport default downloadS3;\n"]},"metadata":{},"sourceType":"module"}